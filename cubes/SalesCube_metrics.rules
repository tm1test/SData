#Region System
FEEDSTRINGS;
SKIPCHECK;
UNDEFVALS;
#EndRegion

#Region MetricsRules
#Rules Generated below will keep the data from source cube 'SalesCube' synchronised with this Metric Cube
#@AutoGenerated
['actvsbud_MI':'Actual'] = DB ('SalesCube','Actual',!region,!model,!account1_metrics,!month);
['actvsbud_MI':'Target'] = DB ('SalesCube','Budget',!region,!model,!account1_metrics,!month);
#EndRegion

#Region N-Calculation rules: Dimension:actvsbud_MI
#Autogenerated CALC NUMERIC 61637476736275645F4D49
   #Region Dimension:actvsbud_MI, Member:Status
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B5374617475735D
   #@AutoGenerated
   ['actvsbud_MI':{'Status'}]=N:IF(ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Score'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(['actvsbud_MI':'Score']>=0, 
   1, 
   IF(['actvsbud_MI':'Score']>=0-1, 
   0, 
   -1)));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Trend
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B5472656E645D
   #@AutoGenerated
   ['actvsbud_MI':{'Trend'}]=N:IF(ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Score'])=1%ISUNDEFINEDCELLVALUE(IF(ATTRS('month', !month, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score')))=1, 
   UNDEFINEDCELLVALUE, 
   IF(ABS(['actvsbud_MI':'Score']-IF(ATTRS('month', !month, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score')))>1*0.05, 
   SIGN(['actvsbud_MI':'Score']-IF(ATTRS('month', !month, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score'))), 
   0));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Tolerance
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B546F6C6572616E63655D
   #@AutoGenerated
   ['actvsbud_MI':{'Tolerance'}]=N:STET;
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Variance
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B56617269616E63655D
   #@AutoGenerated
   ['actvsbud_MI':{'Variance'}]=N:['actvsbud_MI':'Actual']-['actvsbud_MI':'Target'];
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Variance Percent
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B56617269616E63652050657263656E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Variance Percent'}]=N:(['actvsbud_MI':'Actual']-['actvsbud_MI':'Target'])\['actvsbud_MI':'Target'];
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Score
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B53636F72655D
   #@AutoGenerated
   ['actvsbud_MI':{'Score'}]=N:IF(ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Target'])=1%ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Actual'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(IF(ATTRN('account1_metrics', !account1_metrics, 'tolerancetype')=1, 
   ['actvsbud_MI':'Tolerance'], 
   ['actvsbud_MI':'Tolerance']*['actvsbud_MI':'Target'])<>0, 
   MAX(MIN(ROUNDP(0+IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=1, 
   ABS(['actvsbud_MI':'Actual']-['actvsbud_MI':'Target']), 
   ['actvsbud_MI':'Actual']-['actvsbud_MI':'Target'])\ABS(IF(ATTRN('account1_metrics', !account1_metrics, 'tolerancetype')=1, 
   ['actvsbud_MI':'Tolerance'], 
   ['actvsbud_MI':'Tolerance']*['actvsbud_MI':'Target']))*1*IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=0, 
   1, 
   -1)+IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=1, 
   0.5*1, 
   0),5), 10), -10), 
   IF(['actvsbud_MI':'Actual']=['actvsbud_MI':'Target'], 
   0, 
   IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=1  % SIGN(['actvsbud_MI':'Actual']-['actvsbud_MI':'Target']) * IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=0, 
   1, 
   -1) <0, 
   -10, 
   10))));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Score Change
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B53636F7265204368616E67655D
   #@AutoGenerated
   ['actvsbud_MI':{'Score Change'}]=N:IF(((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Score']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('month', !month, 'previousperiod')@='', 
   ['actvsbud_MI':'Trend'], 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score'))))=1),UNDEFINEDCELLVALUE,IF((ATTRS('month', !month, 'previousperiod')@<>''), 
   DB('SalesCube_metrics', !model, !region, !month, !account1_metrics, 'Score')-DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score'), 
   CONTINUE));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Actual Change Percent
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B41637475616C204368616E67652050657263656E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Actual Change Percent'}]=N:IF(((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Actual']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('month', !month, 'previousperiod')@='', 
   ['actvsbud_MI':'Trend'], 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Actual'))))=1),UNDEFINEDCELLVALUE,(((DB('SalesCube_metrics', !model, !region, !month, !account1_metrics, 'Actual')-DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Actual'))\DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Actual'))*100)\100);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_1_Count
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B5374617475735F315F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_1_Count'}]=N:IF(['actvsbud_MI':'Status']=1,1,0);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_0_Count
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B5374617475735F305F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_0_Count'}]=N:IF((['actvsbud_MI':'Status']=0)&((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Status']))=0),1,0);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_-1_Count
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B5374617475735F2D315F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_-1_Count'}]=N:IF(['actvsbud_MI':'Status']=(-1),1,0);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_Incomplete_Count
   #Autogenerated MEMBERCALC NUMERIC 5B61637476736275645F4D495D2E5B5374617475735F496E636F6D706C6574655F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_Incomplete_Count'}]=N:IF((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Status']))=1,1,0);
   #EndRegion
#EndRegion

#Region C-Calculation rules: Dimension:actvsbud_MI
#Autogenerated CALC CONSOLIDATED 61637476736275645F4D49
   #Region Dimension:actvsbud_MI, Member:Status
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B5374617475735D
   #@AutoGenerated
   ['actvsbud_MI':{'Status'}]=C:IF(ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Score'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(['actvsbud_MI':'Score']>=0, 
   1, 
   IF(['actvsbud_MI':'Score']>=0-1, 
   0, 
   -1)));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Trend
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B5472656E645D
   #@AutoGenerated
   ['actvsbud_MI':{'Trend'}]=C:IF(ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Score'])=1%ISUNDEFINEDCELLVALUE(IF(ATTRS('month', !month, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score')))=1, 
   UNDEFINEDCELLVALUE, 
   IF(ABS(['actvsbud_MI':'Score']-IF(ATTRS('month', !month, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score')))>1*0.05, 
   SIGN(['actvsbud_MI':'Score']-IF(ATTRS('month', !month, 'previousperiod')@='', 
   UNDEFINEDCELLVALUE, 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score'))), 
   0));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Tolerance
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B546F6C6572616E63655D
   #@AutoGenerated
   ['actvsbud_MI':{'Tolerance'}]=C:ConsolidatedAvg(2, '', !model, !region, !month, !account1_metrics, !actvsbud_MI);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Variance
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B56617269616E63655D
   #@AutoGenerated
   ['actvsbud_MI':{'Variance'}]=C:['actvsbud_MI':'Actual']-['actvsbud_MI':'Target'];
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Variance Percent
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B56617269616E63652050657263656E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Variance Percent'}]=C:(['actvsbud_MI':'Actual']-['actvsbud_MI':'Target'])\['actvsbud_MI':'Target'];
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Score
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B53636F72655D
   #@AutoGenerated
   ['actvsbud_MI':{'Score'}]=C:IF(ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Target'])=1%ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Actual'])=1, 
   UNDEFINEDCELLVALUE, 
   IF(IF(ATTRN('account1_metrics', !account1_metrics, 'tolerancetype')=1, 
   ['actvsbud_MI':'Tolerance'], 
   ['actvsbud_MI':'Tolerance']*['actvsbud_MI':'Target'])<>0, 
   MAX(MIN(ROUNDP(0+IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=1, 
   ABS(['actvsbud_MI':'Actual']-['actvsbud_MI':'Target']), 
   ['actvsbud_MI':'Actual']-['actvsbud_MI':'Target'])\ABS(IF(ATTRN('account1_metrics', !account1_metrics, 'tolerancetype')=1, 
   ['actvsbud_MI':'Tolerance'], 
   ['actvsbud_MI':'Tolerance']*['actvsbud_MI':'Target']))*1*IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=0, 
   1, 
   -1)+IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=1, 
   0.5*1, 
   0),5), 10), -10), 
   IF(['actvsbud_MI':'Actual']=['actvsbud_MI':'Target'], 
   0, 
   IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=1  % SIGN(['actvsbud_MI':'Actual']-['actvsbud_MI':'Target']) * IF(ATTRN('account1_metrics', !account1_metrics, 'performancepattern')=0, 
   1, 
   -1) <0, 
   -10, 
   10))));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Score Change
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B53636F7265204368616E67655D
   #@AutoGenerated
   ['actvsbud_MI':{'Score Change'}]=C:IF(((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Score']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('month', !month, 'previousperiod')@='', 
   ['actvsbud_MI':'Trend'], 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score'))))=1),UNDEFINEDCELLVALUE,IF((ATTRS('month', !month, 'previousperiod')@<>''), 
   DB('SalesCube_metrics', !model, !region, !month, !account1_metrics, 'Score')-DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Score'), 
   CONTINUE));
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Actual Change Percent
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B41637475616C204368616E67652050657263656E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Actual Change Percent'}]=C:IF(((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Actual']))=1)%((ISUNDEFINEDCELLVALUE(IF(ATTRS('month', !month, 'previousperiod')@='', 
   ['actvsbud_MI':'Trend'], 
   DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Actual'))))=1),UNDEFINEDCELLVALUE,(((DB('SalesCube_metrics', !model, !region, !month, !account1_metrics, 'Actual')-DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Actual'))\DB('SalesCube_metrics', !model, !region, ATTRS('month', !month, 'previousperiod'), !account1_metrics, 'Actual'))*100)\100);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_1_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B5374617475735F315F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_1_Count'}]=C:IF(['actvsbud_MI':'Status']=1,1,0);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_0_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B5374617475735F305F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_0_Count'}]=C:IF((['actvsbud_MI':'Status']=0)&((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Status']))=0),1,0);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_-1_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B5374617475735F2D315F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_-1_Count'}]=C:IF(['actvsbud_MI':'Status']=(-1),1,0);
   #EndRegion
   #Region Dimension:actvsbud_MI, Member:Status_Incomplete_Count
   #Autogenerated MEMBERCALC CONSOLIDATED 5B61637476736275645F4D495D2E5B5374617475735F496E636F6D706C6574655F436F756E745D
   #@AutoGenerated
   ['actvsbud_MI':{'Status_Incomplete_Count'}]=C:IF((ISUNDEFINEDCELLVALUE(['actvsbud_MI':'Status']))=1,1,0);
   #EndRegion
#EndRegion


FEEDERS;
#Region Automatically generated feeders
#Autogenerated AUTOFEEDERS
['actvsbud_MI':'Actual'] => ['actvsbud_MI':'Score'];
['actvsbud_MI':'Status'] => ['actvsbud_MI':'Status_1_Count'];
['actvsbud_MI':'Status'] => ['actvsbud_MI':'Status_0_Count'];
['actvsbud_MI':'Score'] => ['actvsbud_MI':'Score Change'];
['actvsbud_MI':'Score'] => ['actvsbud_MI':'Status'];
['actvsbud_MI':'Score'] => ['actvsbud_MI':'Trend'];
['actvsbud_MI':'Actual'] => ['actvsbud_MI':'Actual Change Percent'];
['actvsbud_MI':'Target'] => ['actvsbud_MI':'Variance Percent'];
['actvsbud_MI':'Status'] => ['actvsbud_MI':'Status_-1_Count'];
['actvsbud_MI':{'Target', 'Actual'}] => ['actvsbud_MI':'Variance'];
#EndRegion